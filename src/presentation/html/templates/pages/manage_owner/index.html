{% set title = "Manage Owner" %}
{% set filename = "/manage-owner" %}
{% extends 'layouts/master.html' %}
{% block content %}
<div class="page-heading">
  <h3>Owner Configuration Dashboard</h3>
</div>
<div class="page-content">
  <!--Row-->
  <!-- Row -->
  <section class="row">
    <div class="row">
      <!-- Middle side columns -->
      <div class="col-lg-12">
        <div class="row">
          <div class="col-lg-12">
            <div class="card">
              <div class="card-body">
                <h5 class="card-title">Owner Access Control</h5>
                <br>
                <form id="owner_form_id" class="row g-3" hx-post hx-swap="none">
                  <div class="col-md-3">
                    <select id="owner_select_id" name="user_id" class="form-select">
                      <option selected="">Select owner</option>
                      {% for user in users %}
                      <option value={{ user.id }}>
                        {{ user.username }}
                      </option>
                      {% endfor %}
                    </select>
                  </div>
                  <div class="col-md-3">
                    <select id="permission_select_id" name="granted" class="form-select">
                      <option selected="">Choose Permission</option>
                      <option value=true>Allowed to Access</option>
                      <option value=false>Disallowed to Access</option>
                    </select>
                  </div>
                  <div class="col-md-3">
                    <select id="project_select_id" class="form-select" hx-get="/project-management/environments"
                      hx-target="#env_select_id" hx-swap="innerHTML" name="project_id">
                      <option selected="">Choose Project</option>
                      <optgroup label="VAPT">
                        {% for project in vapts %}
                        <option value={{ project.id }}>
                          {{ project.name }}
                        </option>
                        {% endfor %}
                      </optgroup>
                      <optgroup label="Compliance">
                        {% for project in compliances %}
                        <option value={{ project.id }}>
                          {{ project.name }}
                        </option>
                        {% endfor %}
                      </optgroup>
                    </select>
                  </div>
                  <div class="col-md-3">
                    <select id="env_select_id" class="form-select" hx-get="/project-management/products"
                      hx-target="#product_select_id" hx-swap="innerHTML" name="environment_id">
                      <option selected="">Choose Environment</option>
                    </select>
                  </div>
                  <div class="col-md-3">
                    <select id="product_select_id" name="product_id" class="form-select">
                      <option selected="">Choose Product</option>
                    </select>
                  </div>
                  <div class="col-sm-12 d-flex justify-content-end">
                    <button type="submit" class="btn btn-primary me-1 mb-1">Submit</button>
                    <button type="reset" class="btn btn-light-secondary me-1 mb-1">Reset</button>
                  </div>
                </form>
                <!-- End No Labels Form -->
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-12 col-md-12">
        <div class="card">
          <div class="card-header">
            <h4>Project List</h4>
          </div>
          <div class="card-body">
            <p>The following is a list of projects, products, and their respective owners.</p>
            <br />
            <div class="row">
              <div class="col-6 border p-2">
                <h5>VAPT</h5>
                <div class="accordion accordion-flush" id="accordionVAPT">
                  {% with projects=vapts,parent_id="accordionVAPT" %}
                  {% include "pages/manage_owner/component/projectAccordion.html" %}
                  {% endwith %}
                </div>
              </div>
              <div class="col-6 border p-2">
                <h5>Compliance</h5>
                <div class="accordion accordion-flush" id="accordionCompliance">
                  {% with projects=compliances,parent_id="accordionCompliance" %}
                  {% include "pages/manage_owner/component/projectAccordion.html" %}
                  {% endwith %}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>
{% endblock %}
{% block js %}
<script>
  document.body.addEventListener("resetOwnerForm", function (evt) {
    document.getElementById("owner_form_id").reset();
  })
</script>
{% endblock %}
